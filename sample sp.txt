CREATE PROC dbo.[BFIL_insertsicollectiondetailsbulk_Arrear]   AS     BEGIN      set nocount on       DECLARE @HiD1  NVARCHAR(30), @tdate DATE         DECLARE cur_clientdata1 CURSOR FOR           SELECT DISTINCT a.hierarchyid           FROM branchmaster (nolock) a  		inner Join ActiveBranchList (nolock) b on a.HierarchyId=b.HierarchyId  		inner join (Select Hierarchyid from DayProcessLog (Nolock)  					where TransactionDate=Convert(Date,Getdate()-1) and CODProcessCompleted=1)  					c on b.HierarchyId=c.HierarchyId          WHERE  sistatusflag = 1  -- and b.HierarchyId='115967'       SET @tdate = CONVERT(DATE, Getdate())             OPEN cur_clientdata1            FETCH next FROM cur_clientdata1 INTO @HiD1            WHILE @@FETCH_STATUS = 0           BEGIN               BEGIN try                           EXEC [BFIL_insertSICollectionDetails_Arrears]   @tdate, @HiD1,'0000'               END try                  BEGIN catch               END catch                  FETCH next FROM cur_clientdata1 INTO @HiD1           END            CLOSE cur_clientdata1            DEALLOCATE cur_clientdata1     END    